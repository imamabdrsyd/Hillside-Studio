<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hillside Studio - Finance</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: { extend: { fontFamily: { sans: ['Plus Jakarta Sans', 'sans-serif'] } } }
        }
    </script>
    <style>
        [data-tab] { display: none; } [data-tab].active { display: block; animation: fadeIn .3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .toast { transform: translateY(100px); opacity: 0; } .toast.show { transform: translateY(0); opacity: 1; transition: all .3s; }
    </style>
</head>
<body class="font-sans bg-gray-50 text-gray-800 min-h-screen flex">
    <!-- Sidebar -->
    <aside class="w-60 bg-white border-r border-gray-200 p-5 flex flex-col fixed h-screen z-50">
        <div class="flex items-center gap-3 mb-8">
            <div class="w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-xl flex items-center justify-center text-white text-xl">üèîÔ∏è</div>
            <h1 class="text-lg font-bold text-indigo-600">hillside studio</h1>
        </div>
        <nav class="flex-1 space-y-1">
            <p class="text-[10px] font-semibold text-gray-400 uppercase px-3 mb-2">General</p>
            <button onclick="showTab('dashboard')" class="nav-btn active w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium bg-indigo-100 text-indigo-600">üè† Dashboard</button>
            <button onclick="showTab('transactions')" class="nav-btn w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium text-gray-500 hover:bg-gray-100">üìã Transactions</button>
            <button onclick="showTab('reports')" class="nav-btn w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium text-gray-500 hover:bg-gray-100">üìä Reports</button>
            <p class="text-[10px] font-semibold text-gray-400 uppercase px-3 mb-2 mt-6">Accounting</p>
            <button onclick="showTab('income')" class="nav-btn w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium text-gray-500 hover:bg-gray-100">üìà Income Statement</button>
            <button onclick="showTab('balance')" class="nav-btn w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium text-gray-500 hover:bg-gray-100">‚öñÔ∏è Balance Sheet</button>
            <button onclick="showTab('cashflow')" class="nav-btn w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium text-gray-500 hover:bg-gray-100">üí∞ Cash Flow</button>
        </nav>
    </aside>

    <!-- Main -->
    <main class="flex-1 ml-60 min-h-screen">
        <header class="bg-white border-b border-gray-200 px-8 py-4 flex items-center justify-between sticky top-0 z-40">
            <div class="flex items-center gap-3 bg-gray-100 px-4 py-2.5 rounded-xl flex-1 mr-6">
                <span>üîç</span>
                <input type="text" id="searchInput" onkeyup="updateTables()" placeholder="Search transactions..." class="bg-transparent border-none outline-none text-sm w-full">
            </div>
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-indigo-100 rounded-xl flex items-center justify-center font-semibold text-indigo-600">IM</div>
                <span class="font-semibold text-sm">Imam</span>
            </div>
        </header>

        <div class="p-8">
            <!-- Dashboard -->
            <div data-tab="dashboard" class="active">
                <div class="grid grid-cols-3 gap-6 mb-6">
                    <div class="col-span-2 bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="font-semibold">Expenses Overview</h3>
                            <span class="font-semibold">2025</span>
                        </div>
                        <div class="h-64"><canvas id="expensesChart"></canvas></div>
                    </div>
                    <div class="space-y-4">
                        <div class="bg-white rounded-2xl p-5 shadow-sm border border-gray-100">
                            <p class="text-sm text-gray-500 mb-2">Net Profit</p>
                            <p class="text-2xl font-bold" id="netProfit">Rp 0</p>
                            <p class="text-xs text-gray-400">Jan - Dec 2025</p>
                        </div>
                        <div class="bg-white rounded-2xl p-5 shadow-sm border border-gray-100">
                            <p class="text-sm text-gray-500 mb-2">Closing Balance</p>
                            <p class="text-2xl font-bold" id="closingBalance">Rp 0</p>
                        </div>
                        <div class="bg-white rounded-2xl p-5 shadow-sm border border-gray-100">
                            <p class="text-sm text-gray-500 mb-2">Gross Margin</p>
                            <p class="text-2xl font-bold text-emerald-600" id="grossMargin">0%</p>
                        </div>
                    </div>
                </div>
                <div class="grid grid-cols-4 gap-6 mb-6">
                    <div class="bg-white rounded-2xl p-5 shadow-sm border border-gray-100">
                        <div class="flex justify-between mb-3"><span class="text-sm text-gray-500">Revenue (EARN)</span><span class="text-emerald-500">‚Üë</span></div>
                        <p class="text-xl font-bold" id="totalEarn">Rp 0</p>
                    </div>
                    <div class="bg-white rounded-2xl p-5 shadow-sm border border-gray-100">
                        <div class="flex justify-between mb-3"><span class="text-sm text-gray-500">Expenses</span><span class="text-red-500">‚Üì</span></div>
                        <p class="text-xl font-bold" id="totalExpense">Rp 0</p>
                    </div>
                    <div class="col-span-2 bg-white rounded-2xl p-5 shadow-sm border border-gray-100">
                        <p class="text-sm text-gray-500 mb-3">Expenses Breakdown</p>
                        <div class="flex items-center gap-6">
                            <div class="relative w-32 h-32">
                                <canvas id="breakdownChart"></canvas>
                                <div class="absolute inset-0 flex flex-col items-center justify-center">
                                    <span class="text-[10px] text-gray-400">Total</span>
                                    <span class="text-xs font-bold" id="breakdownTotal">Rp 0</span>
                                </div>
                            </div>
                            <div class="grid grid-cols-2 gap-2 text-xs flex-1">
                                <div class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-indigo-500"></span>OPEX <span class="ml-auto font-semibold" id="legOpex">0</span></div>
                                <div class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-amber-500"></span>VAR <span class="ml-auto font-semibold" id="legVar">0</span></div>
                                <div class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-blue-500"></span>CAPEX <span class="ml-auto font-semibold" id="legCapex">0</span></div>
                                <div class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-purple-500"></span>FIN <span class="ml-auto font-semibold" id="legFin">0</span></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                    <div class="px-6 py-4 flex items-center justify-between border-b border-gray-100">
                        <h3 class="font-semibold">Transaction History</h3>
                        <select id="monthFilter" onchange="updateTables()" class="bg-gray-100 px-3 py-2 rounded-lg text-sm font-medium">
                            <option value="all">All Months</option>
                            <option value="01">January</option><option value="02">February</option><option value="04">April</option><option value="05">May</option><option value="06">June</option><option value="07">July</option><option value="08">August</option><option value="09">September</option><option value="10">October</option><option value="11">November</option><option value="12">December</option>
                        </select>
                    </div>
                    <table class="w-full">
                        <thead><tr class="bg-gray-50 text-xs text-gray-400 uppercase"><th class="px-6 py-3 text-left">Transaction</th><th class="px-6 py-3 text-left">Date</th><th class="px-6 py-3 text-left">Category</th><th class="px-6 py-3 text-left">Amount</th><th class="px-6 py-3 text-left">Status</th></tr></thead>
                        <tbody id="dashTable" class="divide-y divide-gray-100"></tbody>
                    </table>
                </div>
            </div>

            <!-- Transactions -->
            <div data-tab="transactions">
                <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100 mb-6">
                    <h3 class="font-semibold mb-4 flex items-center gap-2"><span class="w-8 h-8 bg-indigo-100 rounded-lg flex items-center justify-center text-indigo-600">‚ûï</span> Add Transaction</h3>
                    <form id="transactionForm" class="grid grid-cols-5 gap-4">
                        <div><label class="block text-xs font-semibold text-gray-500 mb-1">Date</label><input type="date" id="inputDate" required class="w-full px-3 py-2.5 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent"></div>
                        <div><label class="block text-xs font-semibold text-gray-500 mb-1">Category</label><select id="inputCategory" required class="w-full px-3 py-2.5 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500"><option value="">Select</option><option value="EARN">üü¢ EARN</option><option value="OPEX">üîµ OPEX</option><option value="VAR">üü° VAR</option><option value="CAPEX">üî∑ CAPEX</option><option value="FIN">üü£ FIN</option></select></div>
                        <div><label class="block text-xs font-semibold text-gray-500 mb-1">Description</label><input type="text" id="inputDesc" placeholder="2 nights/Guest" required class="w-full px-3 py-2.5 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500"></div>
                        <div><label class="block text-xs font-semibold text-gray-500 mb-1">Amount (Rp)</label><input type="number" id="inputAmount" placeholder="500000" required min="0" class="w-full px-3 py-2.5 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500"></div>
                        <div><label class="block text-xs font-semibold text-gray-500 mb-1">Account</label><select id="inputAccount" class="w-full px-3 py-2.5 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500"><option>BCA</option><option>Jago</option><option>Cash</option></select></div>
                    </form>
                    <div class="flex gap-3 mt-4">
                        <button onclick="addTransaction()" class="px-5 py-2.5 bg-indigo-500 text-white rounded-xl text-sm font-semibold hover:bg-indigo-600 transition-all">‚ûï Add Transaction</button>
                        <button onclick="showModal()" class="px-5 py-2.5 bg-gray-100 text-gray-700 rounded-xl text-sm font-semibold hover:bg-gray-200">üóëÔ∏è Bulk Delete</button>
                        <button onclick="exportPDF()" class="px-5 py-2.5 bg-gray-100 text-gray-700 rounded-xl text-sm font-semibold hover:bg-gray-200">üìÑ Export PDF</button>
                    </div>
                </div>
                <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                    <div class="px-6 py-4 flex items-center justify-between border-b border-gray-100">
                        <h3 class="font-semibold">All Transactions</h3>
                        <div class="flex gap-2" id="filterBtns">
                            <button onclick="setFilter('all')" class="filter-btn active px-4 py-2 rounded-lg text-xs font-semibold bg-indigo-500 text-white">All</button>
                            <button onclick="setFilter('EARN')" class="filter-btn px-4 py-2 rounded-lg border border-gray-200 text-xs font-semibold text-gray-500 hover:bg-gray-100">EARN</button>
                            <button onclick="setFilter('OPEX')" class="filter-btn px-4 py-2 rounded-lg border border-gray-200 text-xs font-semibold text-gray-500 hover:bg-gray-100">OPEX</button>
                            <button onclick="setFilter('VAR')" class="filter-btn px-4 py-2 rounded-lg border border-gray-200 text-xs font-semibold text-gray-500 hover:bg-gray-100">VAR</button>
                            <button onclick="setFilter('CAPEX')" class="filter-btn px-4 py-2 rounded-lg border border-gray-200 text-xs font-semibold text-gray-500 hover:bg-gray-100">CAPEX</button>
                            <button onclick="setFilter('FIN')" class="filter-btn px-4 py-2 rounded-lg border border-gray-200 text-xs font-semibold text-gray-500 hover:bg-gray-100">FIN</button>
                        </div>
                    </div>
                    <table class="w-full">
                        <thead><tr class="bg-gray-50 text-xs text-gray-400 uppercase"><th class="px-6 py-3 text-left">No</th><th class="px-6 py-3 text-left">Date</th><th class="px-6 py-3 text-left">Description</th><th class="px-6 py-3 text-left">Category</th><th class="px-6 py-3 text-left">Income</th><th class="px-6 py-3 text-left">Expense</th><th class="px-6 py-3 text-left">Account</th><th class="px-6 py-3 text-left">Action</th></tr></thead>
                        <tbody id="trxTable" class="divide-y divide-gray-100"></tbody>
                    </table>
                </div>
            </div>

            <!-- Reports -->
            <div data-tab="reports">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-bold">Financial Reports</h2>
                    <div class="flex gap-3">
                        <select id="reportMonth" class="px-4 py-2 border border-gray-200 rounded-xl text-sm font-semibold"><option value="01">January</option><option value="02">February</option><option value="04">April</option><option value="05">May</option><option value="06">June</option><option value="07">July</option><option value="08">August</option><option value="09">September</option><option value="10">October</option><option value="11">November</option><option value="12" selected>December</option></select>
                        <button onclick="exportMonthlyPDF()" class="px-5 py-2 bg-indigo-500 text-white rounded-xl text-sm font-semibold hover:bg-indigo-600">üìÑ Export Monthly</button>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-6">
                    <div class="bg-white rounded-2xl shadow-sm overflow-hidden"><div class="bg-indigo-500 px-6 py-4"><h3 class="font-semibold text-white">üìä Income Statement</h3></div><div class="p-6" id="incomeReport"></div></div>
                    <div class="bg-white rounded-2xl shadow-sm overflow-hidden"><div class="bg-emerald-500 px-6 py-4"><h3 class="font-semibold text-white">üí∞ Cash Flow</h3></div><div class="p-6" id="cashReport"></div></div>
                </div>
            </div>

            <!-- Income Statement -->
            <div data-tab="income">
                <div class="max-w-2xl bg-white rounded-2xl shadow-sm overflow-hidden">
                    <div class="bg-gradient-to-r from-indigo-500 to-indigo-600 px-6 py-4"><h3 class="font-semibold text-white">HILLSIDE STUDIO LLC</h3><p class="text-indigo-200 text-sm">Income Statement ‚Ä¢ 2025</p></div>
                    <div class="p-6" id="fullIncome"></div>
                </div>
            </div>

            <!-- Balance Sheet -->
            <div data-tab="balance">
                <div class="grid grid-cols-2 gap-6">
                    <div class="bg-white rounded-2xl shadow-sm overflow-hidden"><div class="bg-blue-500 px-6 py-4"><h3 class="font-semibold text-white">ASSETS</h3></div><div class="p-6" id="assetsReport"></div></div>
                    <div class="bg-white rounded-2xl shadow-sm overflow-hidden"><div class="bg-purple-500 px-6 py-4"><h3 class="font-semibold text-white">LIABILITIES & EQUITY</h3></div><div class="p-6" id="equityReport"></div></div>
                </div>
            </div>

            <!-- Cash Flow -->
            <div data-tab="cashflow">
                <div class="max-w-2xl bg-white rounded-2xl shadow-sm overflow-hidden">
                    <div class="bg-gradient-to-r from-emerald-500 to-emerald-600 px-6 py-4"><h3 class="font-semibold text-white">Statement of Cash Flows</h3><p class="text-emerald-200 text-sm">Year 2025</p></div>
                    <div class="p-6" id="fullCash"></div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal -->
    <div id="modal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4">
            <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4 text-3xl">üóëÔ∏è</div>
            <h3 class="text-xl font-bold text-center mb-6">Delete Transactions</h3>
            <div class="space-y-2 mb-6">
                <label class="flex items-center gap-3 p-3 rounded-xl hover:bg-gray-50 cursor-pointer"><input type="radio" name="delType" value="EARN"> Delete all EARN</label>
                <label class="flex items-center gap-3 p-3 rounded-xl hover:bg-gray-50 cursor-pointer"><input type="radio" name="delType" value="OPEX"> Delete all OPEX</label>
                <label class="flex items-center gap-3 p-3 rounded-xl hover:bg-gray-50 cursor-pointer"><input type="radio" name="delType" value="VAR"> Delete all VAR</label>
                <label class="flex items-center gap-3 p-3 rounded-xl hover:bg-gray-50 cursor-pointer"><input type="radio" name="delType" value="CAPEX"> Delete all CAPEX</label>
                <label class="flex items-center gap-3 p-3 rounded-xl hover:bg-gray-50 cursor-pointer"><input type="radio" name="delType" value="FIN"> Delete all FIN</label>
                <label class="flex items-center gap-3 p-3 rounded-xl hover:bg-red-50 cursor-pointer text-red-600"><input type="radio" name="delType" value="ALL"> ‚ö†Ô∏è Delete ALL</label>
            </div>
            <div class="flex gap-3">
                <button onclick="hideModal()" class="flex-1 px-5 py-3 bg-gray-100 rounded-xl font-semibold hover:bg-gray-200">Cancel</button>
                <button onclick="bulkDelete()" class="flex-1 px-5 py-3 bg-red-500 text-white rounded-xl font-semibold hover:bg-red-600">Delete</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast fixed bottom-8 right-8 px-6 py-4 bg-emerald-500 text-white rounded-xl flex items-center gap-3 shadow-xl z-50">
        <span id="toastIcon">‚úÖ</span><span id="toastMsg">Success!</span>
    </div>

    <script>
        const CAPITAL = 350000000;
        let data = [
            {id:1,date:'2025-01-02',cat:'EARN',desc:'4 nights/Laras Dipa',income:1312005,expense:0,acc:'BCA'},
            {id:2,date:'2025-01-04',cat:'FIN',desc:'Owners Withdrawal',income:0,expense:811597,acc:'Cash'},
            {id:3,date:'2025-01-09',cat:'EARN',desc:'2 nights/Edwin',income:609021,expense:0,acc:'BCA'},
            {id:4,date:'2025-01-10',cat:'CAPEX',desc:'Vitrase',income:0,expense:240000,acc:'BCA'},
            {id:5,date:'2025-01-12',cat:'EARN',desc:'1 night/Luisa',income:734464,expense:0,acc:'BCA'},
            {id:6,date:'2025-01-19',cat:'OPEX',desc:'Indihome',income:0,expense:319808,acc:'BCA'},
            {id:7,date:'2025-01-20',cat:'EARN',desc:'3 nights/Karina',income:1029536,expense:0,acc:'BCA'},
            {id:8,date:'2025-01-20',cat:'OPEX',desc:'IPL',income:0,expense:776024,acc:'Jago'},
            {id:9,date:'2025-01-24',cat:'OPEX',desc:'Kosan',income:0,expense:665000,acc:'Jago'},
            {id:10,date:'2025-01-30',cat:'EARN',desc:'2 nights/Paramita',income:790515,expense:0,acc:'BCA'},
            {id:11,date:'2025-02-03',cat:'EARN',desc:'1 night/Dewanti',income:435015,expense:0,acc:'BCA'},
            {id:12,date:'2025-02-05',cat:'CAPEX',desc:'Handuk 2pcs',income:0,expense:147000,acc:'BCA'},
            {id:13,date:'2025-02-10',cat:'EARN',desc:'3 nights/Aqila',income:1208365,expense:0,acc:'BCA'},
            {id:14,date:'2025-02-19',cat:'EARN',desc:'5 nights/Fasyekh',income:1856064,expense:0,acc:'BCA'},
            {id:15,date:'2025-02-20',cat:'OPEX',desc:'IPL',income:0,expense:832300,acc:'BCA'},
            {id:16,date:'2025-02-24',cat:'OPEX',desc:'Kosan',income:0,expense:665000,acc:'Cash'},
            {id:17,date:'2025-04-13',cat:'EARN',desc:'2 nights/Nanang',income:589687,expense:0,acc:'BCA'},
            {id:18,date:'2025-04-20',cat:'OPEX',desc:'IPL',income:0,expense:712600,acc:'BCA'},
            {id:19,date:'2025-05-14',cat:'EARN',desc:'2 nights/Jehan',income:683470,expense:0,acc:'BCA'},
            {id:20,date:'2025-05-14',cat:'EARN',desc:'2 nights/Dinda',income:824595,expense:0,acc:'BCA'},
            {id:21,date:'2025-05-20',cat:'OPEX',desc:'IPL',income:0,expense:781288,acc:'BCA'},
            {id:22,date:'2025-06-01',cat:'EARN',desc:'3 nights/Ashabul',income:1121457,expense:0,acc:'BCA'},
            {id:23,date:'2025-06-07',cat:'EARN',desc:'3 nights/Ronny',income:1073792,expense:0,acc:'BCA'},
            {id:24,date:'2025-06-20',cat:'OPEX',desc:'IPL',income:0,expense:760120,acc:'BCA'},
            {id:25,date:'2025-07-01',cat:'EARN',desc:'1 month/Wanhan',income:4000000,expense:0,acc:'BCA'},
            {id:26,date:'2025-07-01',cat:'EARN',desc:'Rental Deposit',income:2000000,expense:0,acc:'BCA'},
            {id:27,date:'2025-07-23',cat:'OPEX',desc:'Kosan',income:0,expense:700000,acc:'Cash'},
            {id:28,date:'2025-08-01',cat:'EARN',desc:'1 month/Wanhan',income:4000000,expense:0,acc:'BCA'},
            {id:29,date:'2025-08-25',cat:'OPEX',desc:'Kosan',income:0,expense:700000,acc:'Cash'},
            {id:30,date:'2025-08-29',cat:'EARN',desc:'3 nights/Fernando',income:1329000,expense:0,acc:'BCA'},
            {id:31,date:'2025-09-04',cat:'EARN',desc:'2 nights/Difa',income:886000,expense:0,acc:'BCA'},
            {id:32,date:'2025-09-20',cat:'OPEX',desc:'IPL',income:0,expense:698128,acc:'BCA'},
            {id:33,date:'2025-10-04',cat:'EARN',desc:'Megariski',income:483350,expense:0,acc:'BCA'},
            {id:34,date:'2025-10-20',cat:'OPEX',desc:'IPL',income:0,expense:776752,acc:'BCA'},
            {id:35,date:'2025-10-31',cat:'CAPEX',desc:'Showerbox',income:0,expense:3824150,acc:'BCA'},
            {id:36,date:'2025-11-04',cat:'OPEX',desc:'Kosan',income:0,expense:1300000,acc:'Cash'},
            {id:37,date:'2025-11-09',cat:'EARN',desc:'Sales Order',income:500000,expense:0,acc:'BCA'},
            {id:38,date:'2025-11-20',cat:'OPEX',desc:'IPL',income:0,expense:754424,acc:'BCA'},
            {id:39,date:'2025-12-05',cat:'EARN',desc:'2 nights/Nafisa',income:715358,expense:0,acc:'BCA'},
            {id:40,date:'2025-12-10',cat:'OPEX',desc:'Kosan',income:0,expense:1300000,acc:'Cash'},
            {id:41,date:'2025-12-15',cat:'EARN',desc:'4 nights/Nur Aziza',income:1354347,expense:0,acc:'BCA'},
            {id:42,date:'2025-12-20',cat:'OPEX',desc:'IPL',income:0,expense:737700,acc:'BCA'},
            {id:43,date:'2025-12-24',cat:'EARN',desc:'2 nights/Edy',income:908698,expense:0,acc:'BCA'},
            {id:44,date:'2025-12-26',cat:'EARN',desc:'2 nights/Dewi',income:938666,expense:0,acc:'BCA'},
        ];
        let nextId = 100, filter = 'all';

        const fmt = n => 'Rp ' + Math.abs(n).toLocaleString('id-ID');
        const fmtShort = n => n >= 1e6 ? (n/1e6).toFixed(1)+'jt' : (n/1e3).toFixed(0)+'rb';
        const fmtDate = d => new Date(d).toLocaleDateString('id-ID',{day:'2-digit',month:'short',year:'numeric'});
        const badge = c => ({EARN:'bg-emerald-100 text-emerald-700',OPEX:'bg-indigo-100 text-indigo-700',VAR:'bg-amber-100 text-amber-700',CAPEX:'bg-blue-100 text-blue-700',FIN:'bg-purple-100 text-purple-700'}[c]||'bg-gray-100');
        const icon = c => ({EARN:'üí∞',OPEX:'üè¢',VAR:'üîß',CAPEX:'üì¶',FIN:'üí∏'}[c]||'üìÅ');
        const bgCol = c => ({EARN:'#d1fae5',OPEX:'#e0e7ff',VAR:'#fef3c7',CAPEX:'#dbeafe',FIN:'#ede9fe'}[c]||'#f1f5f9');

        function calc() {
            let t = {earn:0,opex:0,var:0,capex:0,fin:0,inc:0,exp:0};
            data.forEach(x => { t.inc+=x.income; t.exp+=x.expense; t[x.cat.toLowerCase()]+=x.income||x.expense; });
            t.net = t.earn - t.opex - t.var;
            t.gross = t.earn - t.var;
            t.cash = t.inc - t.exp;
            t.margin = t.earn > 0 ? ((t.gross/t.earn)*100).toFixed(1) : 0;
            return t;
        }

        function monthly() {
            let m = Array(12).fill(0).map(()=>({i:0,e:0}));
            data.forEach(x => { let mo = new Date(x.date).getMonth(); m[mo].i+=x.income; m[mo].e+=x.expense; });
            return m;
        }

        let chartExp, chartBreak;
        function initCharts() {
            const t = calc(), m = monthly();
            chartExp = new Chart(document.getElementById('expensesChart'),{type:'bar',data:{labels:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],datasets:[{data:m.map(x=>x.e),backgroundColor:'#6366f1',borderRadius:6}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}},scales:{x:{grid:{display:false}},y:{grid:{color:'#f1f5f9'},ticks:{callback:v=>fmtShort(v)}}}}});
            chartBreak = new Chart(document.getElementById('breakdownChart'),{type:'doughnut',data:{labels:['OPEX','VAR','CAPEX','FIN'],datasets:[{data:[t.opex,t.var,t.capex,t.fin],backgroundColor:['#6366f1','#f59e0b','#3b82f6','#8b5cf6'],borderWidth:0}]},options:{responsive:true,maintainAspectRatio:false,cutout:'70%',plugins:{legend:{display:false}}}});
        }

        function updateAll() {
            const t = calc(), m = monthly();
            document.getElementById('netProfit').textContent = fmt(t.net);
            document.getElementById('closingBalance').textContent = fmt(t.cash);
            document.getElementById('grossMargin').textContent = t.margin + '%';
            document.getElementById('totalEarn').textContent = fmt(t.earn);
            document.getElementById('totalExpense').textContent = fmt(t.exp);
            document.getElementById('breakdownTotal').textContent = fmtShort(t.opex+t.var+t.capex+t.fin);
            document.getElementById('legOpex').textContent = fmtShort(t.opex);
            document.getElementById('legVar').textContent = fmtShort(t.var);
            document.getElementById('legCapex').textContent = fmtShort(t.capex);
            document.getElementById('legFin').textContent = fmtShort(t.fin);
            chartExp.data.datasets[0].data = m.map(x=>x.e); chartExp.update();
            chartBreak.data.datasets[0].data = [t.opex,t.var,t.capex,t.fin]; chartBreak.update();
            updateTables();
            updateReports();
        }

        function updateTables() {
            const mf = document.getElementById('monthFilter').value;
            const search = document.getElementById('searchInput').value.toLowerCase();
            let f = data.filter(x => (mf==='all' || x.date.split('-')[1]===mf) && (x.desc.toLowerCase().includes(search) || x.cat.toLowerCase().includes(search)));
            document.getElementById('dashTable').innerHTML = f.slice(-10).reverse().map(x => `<tr class="hover:bg-gray-50"><td class="px-6 py-4"><div class="flex items-center gap-3"><div class="w-9 h-9 rounded-lg flex items-center justify-center" style="background:${bgCol(x.cat)}">${icon(x.cat)}</div><span class="font-medium text-sm">${x.desc}</span></div></td><td class="px-6 py-4 text-sm text-gray-500">${fmtDate(x.date)}</td><td class="px-6 py-4"><span class="px-2.5 py-1 rounded-md text-xs font-semibold ${badge(x.cat)}">${x.cat}</span></td><td class="px-6 py-4 text-sm font-semibold ${x.income>0?'text-emerald-600':'text-red-500'}">${x.income>0?'+':'-'}${fmt(x.income||x.expense)}</td><td class="px-6 py-4"><span class="px-2.5 py-1 rounded-full text-xs font-medium bg-emerald-100 text-emerald-700">‚óè Done</span></td></tr>`).join('');
            let ff = data;
            if(filter!=='all') ff = ff.filter(x=>x.cat===filter);
            if(search) ff = ff.filter(x=>x.desc.toLowerCase().includes(search));
            document.getElementById('trxTable').innerHTML = ff.map((x,i) => `<tr class="hover:bg-gray-50"><td class="px-6 py-4 text-sm">${i+1}</td><td class="px-6 py-4 text-sm">${fmtDate(x.date)}</td><td class="px-6 py-4 text-sm font-medium">${x.desc}</td><td class="px-6 py-4"><span class="px-2.5 py-1 rounded-md text-xs font-semibold ${badge(x.cat)}">${x.cat}</span></td><td class="px-6 py-4 text-sm font-semibold text-emerald-600">${x.income>0?fmt(x.income):'-'}</td><td class="px-6 py-4 text-sm font-semibold text-red-500">${x.expense>0?fmt(x.expense):'-'}</td><td class="px-6 py-4 text-sm">${x.acc}</td><td class="px-6 py-4"><button onclick="del(${x.id})" class="px-3 py-1.5 bg-red-100 text-red-600 rounded-lg text-xs font-semibold hover:bg-red-200">üóëÔ∏è</button></td></tr>`).join('');
        }

        function updateReports() {
            const t = calc();
            const row = (l,v,c) => `<div class="flex justify-between py-2 ${c||''}"><span class="text-gray-500">${l}</span><span class="font-semibold">${v}</span></div>`;
            document.getElementById('incomeReport').innerHTML = row('Revenue (EARN)',fmt(t.earn)) + row('(-) VAR',fmt(t.var)) + `<div class="flex justify-between py-3 border-t-2 border-gray-200 font-bold"><span>Gross Profit</span><span>${fmt(t.gross)}</span></div>` + row('(-) OPEX',fmt(t.opex)) + `<div class="flex justify-between py-3 border-t-2 border-gray-200 font-bold ${t.net>=0?'text-emerald-600':'text-red-500'}"><span>Net Profit</span><span>${fmt(t.net)}</span></div>`;
            document.getElementById('cashReport').innerHTML = row('Cash In (EARN)','+'+fmt(t.earn),'text-emerald-600') + row('Cash Out (OPEX)','-'+fmt(t.opex),'text-red-500') + row('Cash Out (VAR)','-'+fmt(t.var),'text-red-500') + row('Cash Out (CAPEX)','-'+fmt(t.capex),'text-red-500') + row('Cash Out (FIN)','-'+fmt(t.fin),'text-red-500') + `<div class="flex justify-between py-3 border-t-2 border-gray-200 font-bold"><span>Net Cash</span><span>${fmt(t.cash)}</span></div>`;
            document.getElementById('fullIncome').innerHTML = `<div class="bg-emerald-50 px-4 py-3 rounded-xl mb-4"><span class="font-bold text-emerald-700">REVENUE</span></div>` + row('Service Revenue',fmt(t.earn)) + `<div class="flex justify-between py-3 border-t border-gray-200 font-semibold"><span>Total Revenue</span><span>${fmt(t.earn)}</span></div><div class="bg-amber-50 px-4 py-3 rounded-xl my-4"><span class="font-bold text-amber-700">COGS</span></div>` + row('Variable',fmt(t.var)) + `<div class="flex justify-between py-3 border-t border-gray-200 font-semibold"><span>Gross Profit</span><span>${fmt(t.gross)}</span></div>` + row('Margin',t.margin+'%') + `<div class="bg-red-50 px-4 py-3 rounded-xl my-4"><span class="font-bold text-red-700">OPEX</span></div>` + row('Operational',fmt(t.opex)) + `<div class="flex justify-between py-4 px-4 rounded-xl font-bold text-white mt-4 ${t.net>=0?'bg-emerald-500':'bg-red-500'}"><span>NET PROFIT</span><span>${fmt(t.net)}</span></div>`;
            document.getElementById('assetsReport').innerHTML = `<div class="font-semibold text-indigo-600 py-2">Current Assets</div>` + row('Cash & Bank',fmt(t.cash)) + `<div class="font-semibold text-blue-500 py-2 mt-4">Fixed Assets</div>` + row('Property',fmt(CAPITAL)) + row('Equipment (CAPEX)',fmt(t.capex)) + `<div class="flex justify-between py-4 px-4 rounded-xl bg-blue-500 text-white font-bold mt-4"><span>TOTAL ASSETS</span><span>${fmt(CAPITAL+t.cash+t.capex)}</span></div>`;
            document.getElementById('equityReport').innerHTML = `<div class="font-semibold text-red-600 py-2">Liabilities</div>` + row('Accounts Payable','Rp 0') + `<div class="font-semibold text-purple-500 py-2 mt-4">Equity</div>` + row('Paid-in Capital',fmt(CAPITAL)) + row('Retained Earnings',fmt(t.net)) + row('(-) Dividends',fmt(t.fin)) + `<div class="flex justify-between py-4 px-4 rounded-xl bg-purple-500 text-white font-bold mt-4"><span>TOTAL L+E</span><span>${fmt(CAPITAL+t.net-t.fin)}</span></div>`;
            document.getElementById('fullCash').innerHTML = `<div class="bg-emerald-50 px-4 py-3 rounded-xl mb-4"><span class="font-bold text-emerald-700">Operating</span></div>` + row('Cash from customers','+'+fmt(t.earn),'text-emerald-600') + row('Cash paid (OPEX)','-'+fmt(t.opex),'text-red-500') + row('Cash paid (VAR)','-'+fmt(t.var),'text-red-500') + `<div class="flex justify-between py-3 border-t border-gray-200 font-semibold"><span>Net from Operations</span><span>${fmt(t.earn-t.opex-t.var)}</span></div><div class="bg-indigo-50 px-4 py-3 rounded-xl my-4"><span class="font-bold text-indigo-700">Investing</span></div>` + row('Purchase assets','-'+fmt(t.capex),'text-red-500') + `<div class="bg-purple-50 px-4 py-3 rounded-xl my-4"><span class="font-bold text-purple-700">Financing</span></div>` + row('Dividends','-'+fmt(t.fin),'text-red-500') + `<div class="flex justify-between py-4 px-4 rounded-xl bg-gray-800 text-white font-bold mt-4"><span>Net Cash Change</span><span>${fmt(t.cash)}</span></div>`;
        }

        function showTab(name) {
            document.querySelectorAll('[data-tab]').forEach(x=>x.classList.remove('active'));
            document.querySelector(`[data-tab="${name}"]`).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(b=>{b.classList.remove('bg-indigo-100','text-indigo-600');b.classList.add('text-gray-500');});
            event.target.classList.add('bg-indigo-100','text-indigo-600');event.target.classList.remove('text-gray-500');
        }

        function setFilter(f) {
            filter = f;
            document.querySelectorAll('.filter-btn').forEach(b=>{b.classList.remove('bg-indigo-500','text-white');b.classList.add('border-gray-200','text-gray-500');});
            event.target.classList.add('bg-indigo-500','text-white');event.target.classList.remove('border-gray-200','text-gray-500');
            updateTables();
        }

        function addTransaction() {
            const cat = document.getElementById('inputCategory').value;
            const amt = parseFloat(document.getElementById('inputAmount').value);
            if(!cat || !amt) return toast('Please fill all fields','error');
            data.push({id:nextId++,date:document.getElementById('inputDate').value,cat,desc:document.getElementById('inputDesc').value,income:cat==='EARN'?amt:0,expense:cat!=='EARN'?amt:0,acc:document.getElementById('inputAccount').value});
            document.getElementById('transactionForm').reset();
            document.getElementById('inputDate').valueAsDate = new Date();
            updateAll();
            toast('Transaction added!');
        }

        function del(id) { if(confirm('Delete?')) { data = data.filter(x=>x.id!==id); updateAll(); toast('Deleted!'); } }
        function showModal() { document.getElementById('modal').classList.remove('hidden'); }
        function hideModal() { document.getElementById('modal').classList.add('hidden'); }
        function bulkDelete() {
            const sel = document.querySelector('input[name="delType"]:checked');
            if(!sel) return toast('Select category','error');
            const type = sel.value;
            let c = 0;
            if(type==='ALL') { if(!confirm('Delete ALL?')) return; c = data.length; data = []; nextId = 1; }
            else { c = data.filter(x=>x.cat===type).length; data = data.filter(x=>x.cat!==type); }
            hideModal(); updateAll(); toast(`${c} deleted!`);
        }

        function toast(msg, type='success') {
            const t = document.getElementById('toast');
            document.getElementById('toastMsg').textContent = msg;
            document.getElementById('toastIcon').textContent = type==='success'?'‚úÖ':'‚ùå';
            t.className = `toast fixed bottom-8 right-8 px-6 py-4 rounded-xl flex items-center gap-3 shadow-xl z-50 show ${type==='success'?'bg-emerald-500':'bg-red-500'} text-white`;
            setTimeout(()=>t.classList.remove('show'),3000);
        }

        function exportPDF() {
            const {jsPDF} = window.jspdf, doc = new jsPDF();
            doc.setFontSize(18); doc.text('Hillside Studio - Transactions',14,22);
            const t = calc();
            doc.setFontSize(11); doc.text(`Revenue: ${fmt(t.earn)} | Expense: ${fmt(t.exp)} | Profit: ${fmt(t.net)}`,14,32);
            doc.autoTable({head:[['Date','Description','Cat','Income','Expense']],body:data.map(x=>[fmtDate(x.date),x.desc.substring(0,25),x.cat,x.income>0?fmt(x.income):'-',x.expense>0?fmt(x.expense):'-']),startY:40,styles:{fontSize:8},headStyles:{fillColor:[99,102,241]}});
            doc.save('hillside_transactions.pdf'); toast('PDF exported!');
        }

        function exportMonthlyPDF() {
            const {jsPDF} = window.jspdf, doc = new jsPDF();
            const mo = document.getElementById('reportMonth').value;
            const names = ['','January','February','March','April','May','June','July','August','September','October','November','December'];
            const mTrx = data.filter(x=>x.date.split('-')[1]===mo);
            let mt = {earn:0,opex:0,var:0,capex:0,fin:0};
            mTrx.forEach(x=>{if(x.cat==='EARN')mt.earn+=x.income;else mt[x.cat.toLowerCase()]+=x.expense;});
            const np = mt.earn - mt.opex - mt.var;
            doc.setFontSize(20); doc.setTextColor(99,102,241); doc.text('HILLSIDE STUDIO LLC',105,20,{align:'center'});
            doc.setFontSize(14); doc.setTextColor(0,0,0); doc.text('Monthly Report - '+names[parseInt(mo)]+' 2025',105,30,{align:'center'});
            doc.setFillColor(99,102,241); doc.rect(14,40,182,8,'F'); doc.setTextColor(255,255,255); doc.setFontSize(12); doc.text('INCOME STATEMENT',105,46,{align:'center'});
            doc.setTextColor(0,0,0); doc.setFontSize(10); let y = 58;
            doc.text('Revenue',20,y); doc.text(fmt(mt.earn),180,y,{align:'right'}); y+=8;
            doc.text('(-) Variable',20,y); doc.text(fmt(mt.var),180,y,{align:'right'}); y+=8;
            doc.setFont(undefined,'bold'); doc.text('Gross Profit',20,y); doc.text(fmt(mt.earn-mt.var),180,y,{align:'right'}); y+=8;
            doc.setFont(undefined,'normal'); doc.text('(-) OPEX',20,y); doc.text(fmt(mt.opex),180,y,{align:'right'}); y+=10;
            doc.setFillColor(np>=0?16:239,np>=0?185:68,np>=0?129:68); doc.rect(14,y-5,182,10,'F');
            doc.setTextColor(255,255,255); doc.setFont(undefined,'bold'); doc.text('NET PROFIT',20,y+2); doc.text(fmt(np),180,y+2,{align:'right'});
            y+=20; doc.setTextColor(0,0,0); doc.setFillColor(16,185,129); doc.rect(14,y,182,8,'F'); doc.setTextColor(255,255,255); doc.text('TRANSACTIONS',105,y+6,{align:'center'});
            doc.autoTable({head:[['Date','Desc','Cat','Income','Expense']],body:mTrx.map(x=>[fmtDate(x.date),x.desc.substring(0,20),x.cat,x.income>0?fmt(x.income):'-',x.expense>0?fmt(x.expense):'-']),startY:y+12,styles:{fontSize:8},headStyles:{fillColor:[99,102,241]}});
            doc.save(`hillside_${names[parseInt(mo)]}_2025.pdf`); toast('Monthly PDF exported!');
        }

        document.getElementById('inputDate').valueAsDate = new Date();
        initCharts();
        updateAll();
    </script>
</body>
</html>
